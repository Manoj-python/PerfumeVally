{% extends 'admin_panel/base.html' %}
{% load static %}
{% block title %}
  <style>
    body {
      background-color: #f8f9fa;
      padding: 20px;
    }

    .btn-maroon {
      background-color: #8b1538;
      color: white;
    }

    .btn-maroon:hover {
      background-color: #6e102c;
      color: white;
    }

    .nav-tabs .nav-link.active {
      background-color: #f0f0f0;
      border-color: transparent;
    }

    .badge-instock {
      background-color: #28a745;
    }

    .badge-lowstock {
      background-color: #fd7e14;
    }

    .search-box {
      max-width: 300px;
    }

    .gear-icon {
      cursor: pointer;
    }

    .dashboard-card {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
    }
    .toast-body{
      min-width: 300px;
      max-width: 500px;
      color: white;
      font-size: 20px;
      padding: 10px !important;
    }
  </style>
{% endblock title %}
{% block content %}
  <div class="container">
    <h3><strong>Payments</strong></h3>
    <p class="text-muted">Manage your Payments</p>

    <!-- Tabs -->
    <!-- <ul class="nav nav-tabs mb-3">
      <li class="nav-item">
        <a class="nav-link active" href="#">Categories</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Products</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Brands</a>
      </li>
    </ul> -->

    <!-- Search & Buttons -->
    <div class="d-flex justify-content-between align-items-center mb-3">
<form method="get" class="d-flex gap-2 align-items-center mb-3">
  <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="ðŸ” Search..." />
  <input type="date" name="date" value="{{ selected_date }}" class="form-control" />
 {% if query or selected_date %}
<a href="?page={{ page_obj.number }}" class="btn btn-maroon">Clear Filters</a>
{% else %}
  <button type="submit" class="btn btn-maroon">Filter</button>
  
  {% endif %}
</form>      

    </div>

    <!-- Table -->
   <div class="dashboard-card">
  <table class="table align-middle">
    <thead class="table-light">
      <tr>
        <th>Transaction ID</th>
        <th>Customer</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Date</th>

        <th>Payment Method</th>
        <th>Order ID</th>
      </tr>
    </thead>
    <tbody>
      {% for pay in page_obj %}
      <tr data-pay-id="{{ pay.id }}">
        <td>
          {{ pay.transaction_id }}
          <span class="ms-2" style="cursor:pointer;" onclick="copyToClipboard('{{ pay.transaction_id }}')">
            ðŸ“‹
          </span>
        </td>
        <td>{{ pay.order.address.Name }}</td>
          <td>â‚¹ {{ pay.price }}</td>
<td>
          {% if pay.status == "Completed" %}
            <span class="badge bg-success">âœ” Success</span>
          {% else %}
            <span class="badge bg-danger">âœ– Failed</span>
          {% endif %}
        </td>
         <td>
          {{ pay.created_at|date:"D M j" }}
        </td>
        {% if pay.payment_method == "Razorpay" %}
        <td>Prepaid</td>
{% endif %}
      <td>{{ pay.order.id }}</td>
 
       


        
      </tr>
      {% endfor %}
    

 

         
          
        </tbody>
      </table>
    </div>
  </div>
  <script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    showCopyMessage();
  }, function(err) {
    console.error('Failed to copy:', err);
  });
}

function showCopyMessage() {
  const msg = document.createElement('div');
  msg.innerText = 'Copied to clipboard';
  msg.style.position = 'fixed';
  msg.style.bottom = '20px';
  msg.style.left = '50%';
  msg.style.background = 'maroon';
  msg.style.color = 'white';
  msg.style.padding = '8px 12px';
  msg.style.borderRadius = '4px';
  msg.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
  msg.style.zIndex = '1000';
  document.body.appendChild(msg);

  setTimeout(() => {
    msg.remove();
  }, 2000); // disappears after 2 seconds
}
</script>


  <!-- Add Category Modal -->
{% endblock content %}
